<!DOCTYPE html>
<html lang="en">
<head>
  <link rel='stylesheet' href='styleEC.css'>
  <meta charset="UTF-8">
  <title>UK Energy Consumption</title>
  <script src="http://d3js.org/d3.v4.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.js'> </script>
  <!-- <script src="//d3js.org/d3-scale-chromatic.v1.min.js"></script>
  <script src="colorbrewer.js"></script> -->
</head>
<body>
  <header>
    <h1>
      Energy Consumption in the UK, 1990-2015
    </h1>
    <p>Industry and consumer energy consumption in the UK has come increasingly from renewable and waste sources over the last 25 years (up to 2015), according to data maintained and released by the Ricardo Energy and Environment department of the UK Office for National Statistics. It is important to note that the most recent data still shows fossil fuels as the number one energy source by far; it accounted for 82.9% of total energy consumption in 2015. (For a fuller analysis of the sources of 2015’s energy, see pie chart below). However, there is a clear trend of energy consumption from renewable and waste sources replacing fossil fuel sources. Consumer expenditure, manufacturing and electricity, water, gas, steam and air conditioning were consistently the highest energy usage from both fossil fuels and renewable and waste sources. We cannot compare energy usage from fossil fuels directly with usage from renewable and waste sources because there is a vast difference in scale. However, when we calculate the rate of change from year to year, renewable source consumption rises and fossil fuel consumption drops, particularly between 2008 and 2015. Hover over the bars in the chart below to see how much fossil fuel and renewable and waste sources have grown or shrunk from year to year in the UK. This rate of change was calculated from figures in Millions of Tonnes of Oil Equivalent (Mtoe) on a UK Resident Basis.
    </p>
  </header>

<div>
  <h2>Rate of Change in UK Energy Consumption from Fossil Fuels vs. Renewable and Waste Sources</h2>
<h3>1990-2015<h3>
</div>
  <div id="plotlygraph">

  <!-- I created this visualisation through plot.ly Source: https://plot.ly/create/?fid=beccalucks:9 -->

  <a href="https://plot.ly/~beccalucks/9/?share_key=gfqhubLspq6Kxq5NfVeReX" target="_blank" title="Plot 9" style="display: block; text-align: center;">
    <img src="https://plot.ly/~beccalucks/9.png?share_key=gfqhubLspq6Kxq5NfVeReX" alt="Plot 9" style="max-width: 80%; width: 500px;"  width="500" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
  <script data-plotly="beccalucks:9" sharekey-plotly="gfqhubLspq6Kxq5NfVeReX" src="https://plot.ly/embed.js" async>
  </script>
</div>
<div>
  <p> When we break down the energy coming from renewable sources further, we can again clearly see this upward trend. In 1990, renewable and waste sources comprised only 0.68% of the UK’s total energy consumption. By 2008 its share was 2.99% and by 2015 it had shot up to 8.6%. The raw numbers are in Millions of Tonnes of Oil Equivalent (Mtoe), which is a unit representing the energy generated by burning one metric ton (1000 kilograms) of oil or 11.63 Megawatt Hours. On a UK Resident basis, they are broken down by year and specific renewable or waste source below. Hover over each area section in the area chart to see the data for each year.
</p>
</div>

  <!--I created this visualisation using data wrapper Source: https://app.datawrapper.de/chart/UAN4E/publish -->
<div class="graph2header">
  <h2>Energy Consumption from Renewable and Waste Sources 1990-2015</h2>
  <h3>in Millions of Tonnes of Oil Equivalent (Mtoe)</h3>
</div>
<!--I found that creating a <div></div> for each header, content section and visualisation kept me organized and sometimes actaully made a positive impact on formatting. -->
  <div id="datawrapper graph">
    <iframe id="datawrapper-chart-UAN4E" src="//datawrapper.dwcdn.net/UAN4E/2/" scrolling="no" frameborder="0" allowtransparency="true" style="width: 0; min-width: 100% !important;" height="500">
    </iframe>
    <script type="text/javascript">if("undefined"==typeof window.datawrapper)window.datawrapper={};window.datawrapper["UAN4E"]={},window.datawrapper["UAN4E"].embedDeltas={"100":500,"200":500,"300":500,"400":500,"500":500,"700":500,"800":500,"900":500,"1000":500},window.datawrapper["UAN4E"].iframe=document.getElementById("datawrapper-chart-UAN4E"),window.datawrapper["UAN4E"].iframe.style.height=window.datawrapper["UAN4E"].embedDeltas[Math.min(1e3,Math.max(100*Math.floor(window.datawrapper["UAN4E"].iframe.offsetWidth/100),100))]+"px",window.addEventListener("message",function(a){if("undefined"!=typeof a.data["datawrapper-height"])for(var b in a.data["datawrapper-height"])if("UAN4E"==b)window.datawrapper["UAN4E"].iframe.style.height=a.data["datawrapper-height"][b]+"px"});
    </script>
  </div>

  <div>
    <p>
      It is extremely important to be aware that, although the energy consumption trend between 1990 and 2015 has been renewable and waste energy sources replacing fossil fuel sources, fossil fuels still account for the vast majority of industry and individual use. Consumption from nuclear sources and net imports to the UK remained fairly consistent throughout the period.
    </p>
  </div>

<h2>Total Energy Consumption in the UK for 2015 by Source</h2>
<h3>In Millions of Tonnes of Oil Equivalent (Mtoe)</h3>

<div id='piechart'>
</div>

  <script>
  /* Set the parameters */
  var width = 500;
  var height= 500;

  var margin = {
    top: 40,
    left: 40,
    bottom: 40,
    right: 40
  };

  var svg = d3.select('#piechart')
    .append('svg')
    .attr('width', width)
    .attr('height', height);


  width = width - margin.left - margin.right;
  height = height - margin.top - margin.bottom;


  var radius = Math.min(width, height) / 2;
  var g = svg.append("g").attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

  var color_scale = d3.scaleOrdinal(["#ff9999", "#4C91B2", "#008080", "#8ECEDE"]);

  /*It took a lot of fiddling with different color combinations to find a set that matched the color scheme of my site, so I just used a series of colors */

  var pie = d3.pie()
    .sort(null)
    .value(function(d) { return d['Total Consumption in Mtoe (2015)']; });

/*Create the path for the pie chart */

    var path = d3.arc()
       .outerRadius(radius - 10)
       .innerRadius(0);

   var label = d3.arc()
       .outerRadius(radius - 40)
       .innerRadius(radius - 40);

/* Create the tool tip function to hover over each section for more specific information. I consulted https://bl.ocks.org/cflavs/ff1c6005fd7edad32641*/
   var tip = d3.tip()
             .attr('class', 'd3-tip')
             .offset([-10, 0])

  svg.call(tip);
/* load the correct csv data*/
  d3.csv('PieChartData2015.csv', function(d) {

        d['Total Consumption in Mtoe (2015)'] = +d['Total Consumption in Mtoe (2015)'];
        console.log(d);

        return d;}, function(error, data) {
              if(error) throw error;

/* this function builds the info inside of the tool tip*/
              tip.html(function(d){
                return d.data['Energy Source'] + '</br>' + d.data['Total Consumption in Mtoe (2015)'] + ' Mtoe'
              })

/* It took a long time to make the arc a full circle for some reason, also always make sure it's "d.data" before brackets pertaining to specific labels in the data set! Otherwise d3 won't find it. */
/* mousover function for tool tip: */
                  var arc = g.selectAll(".arc")
                  .data(pie(data))
                  .enter().append("g")
                    .attr("class", "arc")
                    .on('mouseover', function(d){
                        tip.show(d)
                    });

                arc.append("path")
                    .attr("d", path)
                    .attr("fill", function(d) { return color_scale(d.data['Energy Source']); });

                arc.append("text")
                    .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
                    .attr("dx", function(d){
                      if(d.data['Energy Source'] === 'Net Imports') {
                        return "-2.5em"
                      } else {
                        '0.35em'
                      }
                    })

                  /* had to play around with if/else statements to ensure that the labels don't run into each other  */
                    .attr("dy", function(d){
                      if(d.data['Energy Source'] === 'Renewable and Waste') {
                        return "5em"
                      } else {

                      }
                    })
                    .attr("dy", function(d){
                      if(d.data['Energy Source'] === 'Fossil Fuels') {
                        return "-3em"
                      } else {

                      }
                    })
                    .style('font-size', '1rem')
                    .text(function(d) { return d.data['Energy Source']; });


});


  </script>


</body>
<footer>
  Data Source: Office for National Statistics
</footer>
</html>
